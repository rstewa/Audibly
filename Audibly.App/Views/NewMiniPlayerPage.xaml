<?xml version="1.0" encoding="utf-8" ?>

<!--  ReSharper disable once Xaml.InvalidResourceType  -->
<Page
    x:Class="Audibly.App.Views.NewMiniPlayerPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:developerTools="using:CommunityToolkit.WinUI.DeveloperTools"
    xmlns:labs="using:CommunityToolkit.Labs.WinUI.MarqueeTextRns"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:userControls="using:Audibly.App.UserControls"
    Background="{ThemeResource AudiblyBackgroundBrush}"
    mc:Ignorable="d">
    <!--  ReSharper disable all Xaml.RedundantResource  -->

    <Page.Resources>
        <userControls:ProgressSliderValueConverter x:Key="ProgressSliderValueConverter" />
    </Page.Resources>

    <Grid RowSpacing="-6">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>


        <!--  TODO: remove this  -->
        <developerTools:AlignmentGrid
            Grid.RowSpan="2"
            Grid.ColumnSpan="2"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            HorizontalStep="4"
            VerticalStep="4"
            Visibility="{x:Bind ViewModel.ShowAlignmentGrids, Mode=OneWay}" />

        <Grid
            Grid.Row="0"
            Grid.Column="1"
            Padding="8,8,0,0"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Center"
            Canvas.ZIndex="1"
            ColumnSpacing="8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!--  drag icon  -->
            <FontIcon
                Grid.Column="0"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                FontFamily="{StaticResource AudiblyCustomFont}"
                FontSize="24"
                Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                Glyph="&#xe904;" />

            <userControls:CoverImageTile
                Grid.Column="1"
                Margin="0,0,4,0"
                CoverImageRadius="6"
                CoverImageSize="60" />

            <!--<userControls:TitleArtistStack
                Grid.Column="1"
                ArtistFontSize="16"
                Spacing="8"
                TitleFontSize="18"
                TitleMaxWidth="130" />-->

            <!--  Title and Artist  -->
            <StackPanel
                x:Name="TitleArtistStackPanel"
                Grid.Column="2"
                Margin="4,-2,0,0"
                HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Orientation="Vertical"
                Spacing="4">

                <!--  Title  -->
                <labs:MarqueeText
                    x:Name="TitleMarqueeText"
                    MaxWidth="130"
                    Behavior="Looping"
                    Direction="Left"
                    FontSize="18"
                    FontWeight="SemiBold"
                    Speed="20"
                    Text="{x:Bind PlayerViewModel.NowPlaying.Title, Mode=OneWay}" />

                <!--  Artist  -->
                <TextBlock
                    x:Name="ArtistTextBlock"
                    FontSize="14"
                    Style="{StaticResource CaptionTextBlockStyle}"
                    Text="{x:Bind PlayerViewModel.NowPlaying.Author, Mode=OneWay}"
                    TextTrimming="CharacterEllipsis" />
            </StackPanel>

            <userControls:PlaySkipButtonsStack
                Grid.Column="3"
                Margin="0,0,-8,0"
                HorizontalAlignment="Center"
                Spacing="-12" />

            <Border
                x:Name="Separator"
                Grid.Column="4"
                Width="1"
                Height="40"
                HorizontalAlignment="Center"
                Background="{ThemeResource AppBarSeparatorForeground}" />

            <StackPanel
                Grid.Column="5"
                VerticalAlignment="Center"
                Orientation="Horizontal"
                Spacing="-8">
                <!--  pin button  -->
                <Button
                    x:Name="PinButton"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="PinButton_Click"
                    ToolTipService.ToolTip="Pin Mini Player">
                    <Button.Resources>
                        <SolidColorBrush x:Key="ButtonBackground">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundPressed">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundDisabled">Transparent</SolidColorBrush>
                    </Button.Resources>
                    <FontIcon
                        FontFamily="Segoe MDL2 Assets"
                        FontSize="16"
                        Glyph="&#xE840;" />
                </Button>

                <!--  unpin button  -->
                <Button
                    x:Name="UnpinButton"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="UnpinButton_Click"
                    ToolTipService.ToolTip="Unpin Mini Player"
                    Visibility="Collapsed">
                    <Button.Resources>
                        <SolidColorBrush x:Key="ButtonBackground">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundPressed">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundDisabled">Transparent</SolidColorBrush>
                    </Button.Resources>
                    <FontIcon
                        FontFamily="Segoe MDL2 Assets"
                        FontSize="16"
                        Glyph="&#xE77A;" />
                </Button>

                <!--  back to library button  -->
                <Button
                    x:Name="BackToLibraryButton"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="BackToLibraryButton_Click"
                    ToolTipService.ToolTip="Back to Library">
                    <Button.Resources>
                        <SolidColorBrush x:Key="ButtonBackground">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundPointerOver">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundPressed">Transparent</SolidColorBrush>
                        <SolidColorBrush x:Key="ButtonBackgroundDisabled">Transparent</SolidColorBrush>
                    </Button.Resources>

                    <FontIcon
                        FontFamily="{StaticResource AudiblyCustomFont}"
                        FontSize="24"
                        Glyph="&#xe901;" />
                </Button>

                <!--  close button  -->
                <!--  <Button  -->
                <!--  Background="Transparent"  -->
                <!--  BorderThickness="0"  -->
                <!--  Click="CloseButton_Click"  -->
                <!--  HorizontalAlignment="Right"  -->
                <!--  ToolTipService.ToolTip="Close Audibly"  -->
                <!--  VerticalAlignment="Center"  -->
                <!--  x:Name="CloseButton">  -->
                <!--     <Button.Resources> -->
                <!--         <SolidColorBrush x:Key="ButtonBackground">Transparent</SolidColorBrush> -->
                <!--         <SolidColorBrush x:Key="ButtonBackgroundPointerOver">Transparent</SolidColorBrush> -->
                <!--         <SolidColorBrush x:Key="ButtonBackgroundPressed">Transparent</SolidColorBrush> -->
                <!--         <SolidColorBrush x:Key="ButtonBackgroundDisabled">Transparent</SolidColorBrush> -->
                <!--     </Button.Resources> -->
                <!--  <FontIcon  -->
                <!--  FontFamily="Segoe MDL2 Assets"  -->
                <!--  FontSize="16"  -->
                <!--  Glyph="&#xE70D;" />  -->
                <!-- </Button> -->
            </StackPanel>
        </Grid>

        <Slider
            Grid.Row="1"
            Grid.ColumnSpan="2"
            HorizontalAlignment="Stretch"
            Canvas.ZIndex="0"
            Maximum="{x:Bind PlayerViewModel.ChapterDurationMs, Mode=OneWay}"
            PointerCaptureLost="NowPlayingBar_OnPointerCaptureLost"
            ThumbToolTipValueConverter="{StaticResource ProgressSliderValueConverter}"
            Value="{x:Bind PlayerViewModel.ChapterPositionMs, Mode=OneWay}">
            <Slider.Resources>
                <x:Double x:Key="SliderHorizontalThumbWidth">8</x:Double>
                <x:Double x:Key="SliderHorizontalThumbHeight">8</x:Double>
                <x:Double x:Key="SliderPreContentMargin">16</x:Double>
                <x:Double x:Key="SliderPostContentMargin">0</x:Double>
                <Thickness x:Key="SliderTopHeaderMargin">0,0,0,0</Thickness>
                <Thickness x:Key="SliderBorderThemeThickness">0</Thickness>
                <CornerRadius x:Key="SliderTrackCornerRadius">0</CornerRadius>
                <x:Double x:Key="SliderOutsideTickBarThemeHeight">0</x:Double>
                <StaticResource x:Key="SliderThumbBackground" ResourceKey="ControlFillColorTransparentBrush" />
                <StaticResource x:Key="SliderOuterThumbBackground" ResourceKey="ControlFillColorTransparentBrush" />
                <StaticResource x:Key="SliderThumbBackgroundPointerOver" ResourceKey="ControlFillColorTransparentBrush" />
                <StaticResource x:Key="SliderThumbBackgroundPressed" ResourceKey="ControlFillColorTransparentBrush" />
                <StaticResource x:Key="SliderThumbBackgroundDisabled" ResourceKey="ControlFillColorTransparentBrush" />
                <StaticResource x:Key="SliderThumbBorderBrush" ResourceKey="ControlFillColorTransparentBrush" />
            </Slider.Resources>
        </Slider>

    </Grid>
</Page>